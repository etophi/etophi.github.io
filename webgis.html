<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>WebGIS - Portofolio Andi</title>
  <link rel="stylesheet" href="style.css">

  <!-- OpenLayers CSS & JS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@latest/ol.css">
  <script src="https://cdn.jsdelivr.net/npm/ol@latest/ol.js"></script>
</head>
<body>
  <header>
    <h1>WebGIS Portofolio</h1>
    <p>Peta interaktif proyek dan lokasi</p>
  </header>

  <nav>
    <a href="index.html">Beranda</a>
    <a href="about.html">Tentang</a>
    <a href="projects.html">Proyek</a>
    <a href="contact.html">Kontak</a>
    <a href="download.html">Download</a>
    <a href="webgis.html" class="active">WebGIS</a>
    <a href="login.html" style="margin-left:auto;font-size:12px;">Admin</a>
  </nav>

  <section>
    <div id="map"></div>
  </section>

  <footer>
    <p>&copy; 2025 Andi Panguriseng</p>
  </footer>

  <script src="script.js"></script>
  <script>
    // Tracking kunjungan
    trackVisit("WebGIS");

    // Inisialisasi peta
    const map = new ol.Map({
      target: 'map',
      layers: [
        new ol.layer.Tile({
          source: new ol.source.OSM()
        })
      ],
      view: new ol.View({
        center: ol.proj.fromLonLat([106.816, -6.200]), // Jakarta
        zoom: 12
      })
    });

    // Data proyek
    const projects = [
      {name:"Proyek 1",lat:-6.200,lng:106.816,desc:"Deskripsi Proyek 1"},
      {name:"Proyek 2",lat:-6.220,lng:106.830,desc:"Deskripsi Proyek 2"},
      {name:"Proyek 3",lat:-6.210,lng:106.800,desc:"Deskripsi Proyek 3"}
    ];

    // Layer vector
    const features = projects.map(p => {
      return new ol.Feature({
        geometry: new ol.geom.Point(ol.proj.fromLonLat([p.lng, p.lat])),
        name: p.name,
        desc: p.desc
      });
    });

    const vectorSource = new ol.source.Vector({ features });
    const vectorLayer = new ol.layer.Vector({
      source: vectorSource,
      style: new ol.style.Style({
        image: new ol.style.Circle({
          radius: 7,
          fill: new ol.style.Fill({ color: '#1a73e8' }),
          stroke: new ol.style.Stroke({ color: '#fff', width: 2 })
        })
      })
    });
    map.addLayer(vectorLayer);

    // Popup
    const container = document.createElement('div');
    container.className = 'ol-popup';
    const content = document.createElement('div');
    container.appendChild(content);

    const overlay = new ol.Overlay({
      element: container,
      autoPan: true,
      autoPanAnimation: { duration: 250 }
    });
    map.addOverlay(overlay);

    map.on('singleclick', function(evt) {
      const feature = map.forEachFeatureAtPixel(evt.pixel, f => f);
      if (feature) {
        const coordinates = feature.getGeometry().getCoordinates();
        content.innerHTML = `<b>${feature.get('name')}</b><br>${feature.get('desc')}`;
        overlay.setPosition(coordinates);
      } else {
        overlay.setPosition(undefined);
      }
    });

    // Contoh area lingkaran
    const circleFeature = new ol.Feature({
      geometry: new ol.geom.Circle(ol.proj.fromLonLat([106.815, -6.215]), 500)
    });
    circleFeature.setStyle(new ol.style.Style({
      stroke: new ol.style.Stroke({ color: 'red', width: 2 }),
      fill: new ol.style.Fill({ color: 'rgba(255,0,0,0.3)' })
    }));
    vectorSource.addFeature(circleFeature);
  </script>
</body>
</html>
